{"is_source_file": true, "format": "JavaScript", "description": "This source file provides database utility functions for executing parameterized queries and managing transactions, along with error mapping for PostgreSQL-specific error codes.", "external_files": ["./pool", "../errors/apiError"], "external_methods": ["require('./pool').pool.query", "require('../errors/apiError').ApiError"], "published": ["dbQuery", "withTransaction"], "classes": [], "methods": [{"name": "mapPgError(err)", "description": "Maps PostgreSQL error codes to custom ApiError instances with appropriate HTTP status codes and messages.", "scope": "", "scopeKind": ""}, {"name": "dbQuery(text, params, client)", "description": "Executes a parameterized SQL query using either a provided database client or a shared connection pool.", "scope": "", "scopeKind": ""}, {"name": "withTransaction(fn)", "description": "Executes a callback function within a database transaction, managing commit and rollback automatically.", "scope": "", "scopeKind": ""}], "calls": ["pool.query", "client.query('BEGIN')", "client.query('COMMIT')", "client.query('ROLLBACK')", "client.release()"], "search-terms": ["query.js", "PostgreSQL error mapping", "transaction management", "db query wrapper", "error handling"], "state": 2, "file_id": 15, "knowledge_revision": 56, "git_revision": "", "ctags": [{"_type": "tag", "name": "dbQuery", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/db/query.js", "pattern": "/^async function dbQuery(text, params, client) {$/", "language": "JavaScript", "kind": "function", "signature": "(text, params, client)"}, {"_type": "tag", "name": "dbQuery", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/db/query.js", "pattern": "/^module.exports = { dbQuery, withTransaction };$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "mapPgError", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/db/query.js", "pattern": "/^function mapPgError(err) {$/", "language": "JavaScript", "kind": "function", "signature": "(err)"}, {"_type": "tag", "name": "withTransaction", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/db/query.js", "pattern": "/^async function withTransaction(fn) {$/", "language": "JavaScript", "kind": "function", "signature": "(fn)"}], "hash": "4d0c405a6a6e851e7d63f6cae70f33ed", "format-version": 4, "code-base-name": "decision_replay_backend", "filename": "decision_replay_backend/src/db/query.js", "fields": [{"name": "module.exports = { dbQuery, withTransaction };", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"56": ""}]}