{"is_source_file": true, "format": "JavaScript", "description": "This file defines service functions for managing decision records in a backend application, including listing, retrieving, creating, updating, and deleting decisions. It also includes helper functions for analysis such as quality scoring and bias detection.", "external_files": ["../db/query", "../errors/apiError", "./audit"], "external_methods": ["dbQuery", "withTransaction", "ApiError", "writeAuditLog"], "published": ["listDecisions", "getDecision", "createDecision", "updateDecision", "deleteDecision", "computeQualityAndBias"], "classes": [], "methods": [{"name": "normalizeJson(v, fallback)", "description": "Normalizes a value to a fallback if undefined or null.", "scope": "", "scopeKind": ""}, {"name": "ensureDecisionOwner({ decisionId, userId, client })", "description": "Verifies that the decision belongs to the specified user.", "scope": "", "scopeKind": ""}, {"name": "listDecisions({ userId, q, status, limit = 50, offset = 0 })", "description": "Lists decisions for a user with optional filtering by query and status.", "scope": "", "scopeKind": ""}, {"name": "getDecision({ userId, decisionId })", "description": "Retrieves a specific decision by ID for a user.", "scope": "", "scopeKind": ""}, {"name": "createDecision({ userId, payload, ip, userAgent, requestId })", "description": "Creates a new decision record in the database.", "scope": "", "scopeKind": ""}, {"name": "updateDecision({ userId, decisionId, payload, ip, userAgent, requestId })", "description": "Updates an existing decision record with provided payload.", "scope": "", "scopeKind": ""}, {"name": "deleteDecision({ userId, decisionId, ip, userAgent, requestId })", "description": "Soft-deletes a decision, marking it as deleted.", "scope": "", "scopeKind": ""}, {"name": "computeQualityAndBias(payload)", "description": "Calculates a simple quality score and detects bias signals based on decision payload.", "scope": "", "scopeKind": ""}], "calls": ["dbQuery", "withTransaction", "writeAuditLog"], "search-terms": ["decisions", "decision service", "decision management", "decision CRUD", "decision analysis", "Bias detection", "Quality scoring"], "state": 2, "file_id": 21, "knowledge_revision": 66, "git_revision": "41505f54f63608c133aba6ba1bb06fb649cc1442", "ctags": [{"_type": "tag", "name": "computeQualityAndBias", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^function computeQualityAndBias(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "createDecision", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^async function createDecision({ userId, payload, ip, userAgent, requestId }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ userId, payload, ip, userAgent, requestId })"}, {"_type": "tag", "name": "deleteDecision", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^async function deleteDecision({ userId, decisionId, ip, userAgent, requestId }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ userId, decisionId, ip, userAgent, requestId })"}, {"_type": "tag", "name": "ensureDecisionOwner", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^async function ensureDecisionOwner({ decisionId, userId, client }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ decisionId, userId, client })"}, {"_type": "tag", "name": "getDecision", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^async function getDecision({ userId, decisionId }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ userId, decisionId })"}, {"_type": "tag", "name": "listDecisions", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^async function listDecisions({ userId, q, status, limit = 50, offset = 0 }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ userId, q, status, limit = 50, offset = 0 })"}, {"_type": "tag", "name": "listDecisions", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^module.exports = { listDecisions, getDecision, createDecision, updateDecision, deleteDecision, c/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeJson", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^function normalizeJson(v, fallback) {$/", "language": "JavaScript", "kind": "function", "signature": "(v, fallback)"}, {"_type": "tag", "name": "updateDecision", "path": "/home/kavia/workspace/code-generation/decision-insight-platform-325145-325154/decision_replay_backend/src/services/decisions.js", "pattern": "/^async function updateDecision({ userId, decisionId, payload, ip, userAgent, requestId }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ userId, decisionId, payload, ip, userAgent, requestId })"}], "hash": "d1aa0b322acf14c298e6477f58eb46f8", "format-version": 4, "code-base-name": "decision_replay_backend", "filename": "decision_replay_backend/src/services/decisions.js", "fields": [{"name": "module.exports = { listDecisions, getDecision, createDecision, updateDecision, deleteDecision, c/", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"66": "41505f54f63608c133aba6ba1bb06fb649cc1442"}]}